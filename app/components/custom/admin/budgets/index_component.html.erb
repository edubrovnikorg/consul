<%= header do %>
  <div class="header-buttons">
    <%= link_to t("admin.budgets.index.new_admin_budget_images_link"), admin_budget_images_path %>
    <%= link_to t("admin.budgets.index.new_link"), new_admin_budget_path %>
  </div>
<% end %>

<%= render Admin::Budgets::HelpComponent.new("budgets") %>
<%= render "shared/filter_subnav", i18n_namespace: "admin.budgets.index" %>

<% if budgets.any? %>
  <% if false %>
  <h3><%= page_entries_info budgets %></h3>
  <% end %>

  <table class="budgets-table">
    <thead>
      <tr>
        <th><%= t("admin.budgets.index.table_name") %></th>
        <th><%= t("admin.budgets.index.table_phase") %></th>
        <th>SljedeÄ‡a <%= t("admin.budgets.index.table_phase") %></th>
        <th><%= t("admin.budgets.index.table_duration") %></th>
        <th><%= t("admin.actions.actions") %></th>
      </tr>
    </thead>
    <tbody>
      <% budgets.each do |budget| %>
        <tr id="<%= dom_id(budget) %>" class="budget">
          <td class="<%= "budget-completed" if budget.finished? %>">
            <% if budget.finished? %>
              <span>
                <%= t("admin.budgets.index.table_completed") %>
              </span>
            <% end %>
            <strong><%= budget.name %></strong>
          </td>
          <td>
            <%= budget.current_phase.name %>
            <small><%= phase_progress_text(budget) %></small>
          </td>
          <td>
            <% if budget.phase == 'accepting' %>
              <%= link_to t("admin.budgets.index.next_phase.reviewing"), publish_admin_budget_path(budget), method: :patch %>
            <% elsif budget.phase == 'reviewing'%>
              <%= link_to t("admin.budgets.index.next_phase.selecting"), next_phase_admin_budget_path(budget), method: :patch %>
            <% elsif budget.phase == 'selecting' %>
              <%= link_to t("admin.budgets.index.next_phase.finished"), next_phase_admin_budget_path(budget), method: :patch %>
            <% end %>
          </td>
          <td>
            <%= dates(budget) %><br />
            <%= duration(budget) %>
          </td>
          <td>
            <%= render Admin::Budgets::TableActionsComponent.new(budget) %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= paginate budgets %>
<% else %>
  <div class="callout primary">
    <%= t("admin.budgets.index.no_budgets") %>
  </div>
<% end %>
